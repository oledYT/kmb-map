<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>路线地图</title>
  <script charset="utf-8" src="https://map.qq.com/api/gljs?v=1.exp&key=FNMBZ-RKIWB-MQ3UL-NKSLR-H5SFF-JQBNG"></script>
  <style>
    html, body, #container {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
    }
  </style>
</head>
<body>
  <div id="container"></div>
  <script>
    let map = new TMap.Map("container", {
      center: new TMap.LatLng(22.3364, 114.1766), // 初始中心点
      zoom: 13
    });

    let polyline = new TMap.MultiPolyline({
      map: map,
      geometries: []
    });

    function drawRoute(coordArray) {
    if (!Array.isArray(coordArray)) {
        console.error("drawRoute 参数无效");
        return;
    }

    const path = coordArray.map(item => {
        const [latStr, lngStr] = item.replace("[", "").replace("]", "").split(",");
        return new TMap.LatLng(parseFloat(latStr), parseFloat(lngStr));
    });

    if (window.routeLine) {
        window.routeLine.setPath(path);
    } else {
        window.routeLine = new TMap.Polyline({
            map: map,
            path: path,
            strokeColor: '#3777FF',
            strokeWeight: 6,
        });
    }

    // 自动调整视野到路线
    if (path.length > 0) {
        map.setCenter(path[Math.floor(path.length / 2)]);
        map.setZoom(13);
    }
}
  </script>
</body>
</html>
